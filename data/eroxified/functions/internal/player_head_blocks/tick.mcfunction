execute as @a if predicate eroxified:player_head_blocks/holding_head_with_saved_data at @s run function eroxified:internal/player_head_blocks/saved_data/hold
execute as @a[tag=eroxified.player_head_blocks.holding_head_with_saved_data] unless predicate eroxified:player_head_blocks/holding_head_with_saved_data at @s run function eroxified:internal/player_head_blocks/saved_data/stop_holding

execute as @a at @s rotated as @s anchored eyes positioned ^ ^ ^3 as @e[type=marker,tag=eroxified.player_head_blocks.marker,distance=..4,predicate=!eroxified:player_head_blocks/player_head] at @s run function eroxified:internal/player_head_blocks/despawn_attempt
execute as @a at @s rotated as @s anchored eyes positioned ^ ^ ^3 as @e[type=marker,tag=eroxified.player_head_blocks.marker,distance=..4,predicate=eroxified:player_head_blocks/player_head,sort=random,limit=1] at @s run function eroxified:internal/player_head_blocks/despawn_attempt
execute as @a at @s rotated as @s anchored eyes positioned ^ ^ ^3 as @e[type=armor_stand,tag=eroxified.player_head_blocks.armor_stand,distance=..4,predicate=!eroxified:player_head_blocks/player_head] at @s run function eroxified:internal/player_head_blocks/despawn_attempt
execute as @a at @s rotated as @s anchored eyes positioned ^ ^ ^3 as @e[type=armor_stand,tag=eroxified.player_head_blocks.armor_stand,distance=..4,predicate=eroxified:player_head_blocks/player_head,sort=random,limit=1] at @s run function eroxified:internal/player_head_blocks/despawn_attempt

execute as @e[type=#eroxified:marker_or_armor_stand,tag=!eroxified.player_head_blocks.particle.far,tag=eroxified.player_head_blocks.particle.025] if predicate eroxified:random/1_5 at @s if entity @a[distance=..32] run function eroxified:internal/player_head_blocks/particle
execute as @e[type=#eroxified:marker_or_armor_stand,tag=!eroxified.player_head_blocks.particle.far,tag=eroxified.player_head_blocks.particle.05] if predicate eroxified:random/1_10 at @s if entity @a[distance=..32] run function eroxified:internal/player_head_blocks/particle
execute as @e[type=#eroxified:marker_or_armor_stand,tag=!eroxified.player_head_blocks.particle.far,tag=eroxified.player_head_blocks.particle.1] if predicate eroxified:random/1_20 at @s if entity @a[distance=..32] run function eroxified:internal/player_head_blocks/particle
execute as @e[type=#eroxified:marker_or_armor_stand,tag=!eroxified.player_head_blocks.particle.far,tag=eroxified.player_head_blocks.particle.2] if predicate eroxified:random/1_40 at @s if entity @a[distance=..32] run function eroxified:internal/player_head_blocks/particle
execute as @e[type=#eroxified:marker_or_armor_stand,tag=!eroxified.player_head_blocks.particle.far,tag=eroxified.player_head_blocks.particle.5] if predicate eroxified:random/1_100 at @s if entity @a[distance=..32] run function eroxified:internal/player_head_blocks/particle
execute as @e[type=#eroxified:marker_or_armor_stand,tag=!eroxified.player_head_blocks.particle.far,tag=eroxified.player_head_blocks.particle.10] if predicate eroxified:random/1_200 at @s if entity @a[distance=..32] run function eroxified:internal/player_head_blocks/particle


execute as @e[type=#eroxified:marker_or_armor_stand,tag=eroxified.player_head_blocks.particle.far,tag=eroxified.player_head_blocks.particle.025] if predicate eroxified:random/1_5 at @s if entity @a[distance=..128] run function eroxified:internal/player_head_blocks/particle
execute as @e[type=#eroxified:marker_or_armor_stand,tag=eroxified.player_head_blocks.particle.far,tag=eroxified.player_head_blocks.particle.05] if predicate eroxified:random/1_10 at @s if entity @a[distance=..128] run function eroxified:internal/player_head_blocks/particle
execute as @e[type=#eroxified:marker_or_armor_stand,tag=eroxified.player_head_blocks.particle.far,tag=eroxified.player_head_blocks.particle.1] if predicate eroxified:random/1_20 at @s if entity @a[distance=..128] run function eroxified:internal/player_head_blocks/particle
execute as @e[type=#eroxified:marker_or_armor_stand,tag=eroxified.player_head_blocks.particle.far,tag=eroxified.player_head_blocks.particle.2] if predicate eroxified:random/1_40 at @s if entity @a[distance=..128] run function eroxified:internal/player_head_blocks/particle
execute as @e[type=#eroxified:marker_or_armor_stand,tag=eroxified.player_head_blocks.particle.far,tag=eroxified.player_head_blocks.particle.5] if predicate eroxified:random/1_100 at @s if entity @a[distance=..128] run function eroxified:internal/player_head_blocks/particle
execute as @e[type=#eroxified:marker_or_armor_stand,tag=eroxified.player_head_blocks.particle.far,tag=eroxified.player_head_blocks.particle.10] if predicate eroxified:random/1_200 at @s if entity @a[distance=..128] run function eroxified:internal/player_head_blocks/particle